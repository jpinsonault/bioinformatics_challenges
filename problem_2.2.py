from collections import defaultdict
from pprint import pprint
import re
import operator
from time import time
import sys

from utils import *

rna_string = "TCCTTCCCTCGATTATACAAGTCTGGCTAGCCGACTTGCTCATGATTTCTCCATTCTGCAGGGCGCAAGAACCTTCTAGACGGTGCTGTACGTGCACAACGCCGCAGAGGGGGGCGGGGAGAAGATCCGTTTGGCAGCAGCACCATTACGAGTGTCATTATCCATGTTAAGCTGTTCAACGGTTCATTGAGCGATCGGGTCTGTCTGATCGACCAATAGGTCCCGGCAGTATCCATGTGCTAGGAAGACTGCACGTCAGATGAGGAAAAAATTCAATACGGTTGGTAATCGTTGGAGCCTTACGTTGTGGAACGCGTCATTCGAAGCAGGCCAATGGTGAAATCATGTCAAAGTCTCCGTTGTGCGAGAGAATTCGGCAAGATTAGCCCGTGTGTATGAGACCTGTACATAGCAGCCTTATTAACCGCTAAGTCAGTCAACTGGCACGTGCGCGTAGATGAGAACACCTGGTAAATACCGCGGTTACGCACGTTCGTACTCGGAGTGGTAGCGCCGGTATTTGAACCCGAGCTCAATCATGCTGTTGGCGGGACAAAAAGTACATGCCTTTATGTGGGGCAGGGCTTTGAATCTTATCCATGACATATTCGCCGAATCGCCCCGCTTAACTTTCCGATCGAGGTGTTGAGCTCAGGGCATAGATGAAAGTTACTATCGTCGACTTTGAACTCCCCCGCTAACCGCAACTTTTCTACCGCTTGAGCTCATAGGAATCGAGAGGAAACGGCGAAATTATGTCCAAGTCGTCGCCGTTACCCCGCAGATAGTGACAATATAATGATAAAGCCTTGTTTGACTAAGGCTGGGATACATTGTCTATTCGCATCAGAATGATCGAATTATCGCAAGTTGACATCTCGAACCATGTAACCAGTAGATGGCGGAGATATTTGTCCGCAATCTTCTACGTTAAACTCAAAAATCTTCTGTACAAAGATAGTTCTTCAAGGCCGGGGTGAAGGTACGATTGAAGTGGAACGGTGCGTATCATGGGTCTATTAACCCTACTGCCTAAAGCAGAATCCCGAAACATCCGTTAATAAGCCCCTTTAGAGGAACGGGTTCTATACAAGGCCCAAATCTACGGCATTACCACGCAACTCGACGCCAGGGGGAACCCGGTTTAGAGGACGTAGCGACACGATGTAGACTTCATGACGCCCAGTTATTTGAACCATTTCAATACGGAGTGTAGAATGATCAGGTGCACAAGAATTAGCGTAGGAAAATGTTGTTACACCCTACCCGGGGAGCGATCTGGCGTCCCAGGTCACATAAATCGGTCGGTCACTACACAGCCCGAGATAACTGGCGGGCTGCACATCGCGCAGCTGCCAGCCTAGTACTCAGTCGGTGGGATGCCCCCCTCTGATCAATTCTAAGTCCAGATAATATGGAGACGCTATATTACCCCTGATCAGCGATGAATTCTCAATTTTAAAGATATCCAAGCAGTAGCTTAAAACATAAATTCCTTCCGTTGATCCCATTTTCTCAAGTTTGGTCGCCGACGAGGTGGCGGATAAAACCCCGCGATTAAGGCTGCCTTGAACCCAGTGACTGGGGGGTATCCCGCGGCCGTCCATTTGTGCTGTCATGGCGGTACACTAGTGGTGCCACCTCAAACTCACACAATACCTTCTGGCCCCGATTCCTTGTACTCATTAGACTCACTGCGACGGTGATAACGGACATTGTGGATACCCGCCCAGAAGTCGCTAGCCGCTGCAGAGTCTTTGCACAAATGCGGGAACCAGCGAAATTGACTTCTGACGATGGGTGGTCTCTCCTTGCAGCTAAATGATGTGGAAATATTTCACTTCCGGTCCTTACTCATAACCCCCTGAGAGGGTCCGAAGAGTTTCGACGCGGGCAGGCCGAACTGTCTAGTGGAAACAACCAGCAGTACCAAGTCTGATTTCGACATTATCTCGCCGTTATGATTATGAATTGGGTAGCGACGGCCGATACCAGAAGGAGGTAATCATATTTTAGGGGGTGCCGGGACACAGATCGATACCTCAAAGGCCTAACGCAACGCCTCTTTCATCGGGCAGTTTCATTCTCGTAACTGCAGTGAGCAAAGTCACCCCTAAGCAGAAAATTGAGAACTCTAACTGTACCTGTTAACCACACGCTGGGAGGCACCGCTGTGTCCTCCTAACTGTATCTAGTACTCAGCTGGGCCTTCAAATGGTGAGATAATGTCGAAATCCGGGGACTCAACTGGTTCGAGATGTTGGTTTGGACTCACCCACGGCAAACGAGAAGTAACTTGGACTGGGATGACTAAAAGGACTAACTCTTTCATAAGGGCTACGTTCGGCATTTTATGCGGATTGGCATGTACAACTATATGGATCATCAGTATGTGAGTGGGCATCAGGTCGTGTCGCGGGACTTGCCGCGTTGAGGGGGTCCAGTTGCTCACAGGTTGACTGAATATTACGGTTAACTAGGCTCCAAAAGTGAGGTGGTCAGGCCCCGGATTTAGACATAATTTCACCGTTTGACATTATACTTCCCTGACTAAGTCTCTCTATTATTGATAACTGTGTGCGTAATAATTCACAGGCATGCCCCGTTACCTCCGCTGAGTGTTGAGGGGTTGTCCGTCCTACACGATGAGTACTTGCCGTTTAGATGGCTCGTAGTGTAATATTCCTTTGCGTAGTTGACCAGCAGCGGGCGGCGTAATGGTAGTTTGAGAACATAAACGTATTGTAACGAGACAACCAGGCACCTCTTCCATAGATGGTTTAGCTATCAACAGTAGGTGTGGCACGTGGGTCGTGCCATGCCTAGTAGAGGGTTATCACGCGGGAGGCCTCTATCCGACTCAAAAACCGCCTCAGTATCGAAATCCCGTTTGGTGAGGTCCGGTTTAAGCATGTTAGCCATGTAGTGAGTTGACCTCGACTCATCAGGTGCGCAAATAAAGAATGCCCGTTAAACGGCCCTAATACTTCAGATAGGACTGCCATCACACACTCTTTGGCCGAGGCGATCCGCGTTGCGCTTGCGCCTGTCAACCAACTTTTTTTTGGGTTGGGCAAGCAACTGCAGCAACCACGCCGTTCTCCCGATGGGTCAAGGGATAAAAACCAGAGTCACTCGTATGGGATCTTTCGCTTGTCGCAGTCCGGAGGGCTTCAGCCCCGGTAATCACGTAAGTCGGCTAGCTCTGCTTCGGACCACGTATTAGACTACGGCCTGATGTACAGTGCAAAGAGGTTTTGAGCCGGGTGCCCCAACAGGGTAACACGGGTGATAGGAATTGACTGGACCACAGAGGCGCCGAAGGTCGCCAACATCGGGAAGCGGCAACTATGGTCGAAGACCCTGGAAGTAATCTCGACTGAATGGGTTGCATCTGTGCTCCCGCAGTGCGAGGCACCCGCGCAGGTATAGTGTCTTACGGGGTCTATCGCTCTTGCTGAATCGCCTTACCCGAACGGAGAGATTATGTCTAAGTCTTGACCTCACGAATAAAAGAGTAGCTTACCCTACGAGTTAGTGGGCAGAGTCGCGGGTCCACGAATCGATCGTACCCGCTAGACCGGCTACGGTATACACGACATAGAGCTGGAGCCGTCTTGAATCACAATTAACTGTAATGGGGAGATCATGTCTAAATCTTAGACCAGCAATGGGGAGATAATGTCAAAGTCAGTTTGCTAGCTTGCGACATCGACAGCTGCAGATCTTCTACCTAATATAAGACCGGTAATCCGTCCTAGACCATAACGCTGCCTGGATGTCAAGACCGCCAAGATAGCGTTTGTGCGTGACCACAGGGCGCTTTGGGTCCTACCTGGGTTGTCGACCAAAATCTAGACTCCCGTATCAGACTAAAGGCTCGATTCCCTAATAATTGATGTAATAGGTACAGGTTGTGGCCAGGCAGTAGCACCCCGTTAGGTACACGCGTACCCCTCAACTCTATTGTTATCGTGGTTACCTCAGCACGAAGGGGTGGCTACGTCTTATGATTCCGACTACGCAATGACGGCCAGACTGACAGTAGCAGTGGTATGTGCCCGTCCTCTTATGTGCTAGGTCAGATGGTGGGGCGCCTGGATGCACACCTAATTCACGACTGCACATCGCGACTGACCCTCCAGTTCAGACTACTCGACGGACCGGAGGTGAAACTAGGTTCCGATAGACTAGCAAATCCCTGACAAGAGAAGCCCCTCAGACACGAAACGCCAGGATTGAATTCAATTCGAATTGGTGATCCTGCTTCCCTTTATCGGCTCGTGACGCCGGCGAATGACTGATCACCCGTTGGTCGCACGTCCGTTGTTTGTCTTGCTATGCCTTATACACCCACCGGGAGTGGGGTTTCACTGACCACGACTATATTATTGCGTTTGTCTAAGAAGCAAAATAGGACAGGGGCTCAATGTACTAGTAACTGTACCGACGCCGTTGCTTATGGCGGGGGTTAGCGGTTTTAAATCGACTATTAACGCGCACTGGACATAAAGGTTCAACTCCTGGTTAAAGGACAGCAGCACTTATTAAGCGGGGACGCCAGTGCCGACTTTTAGACATAATTTCCCCATTTGTTCTAGGACTTACTCATTATTTCGCCATTAACCATCCACATGTGCGCAAGTCGGCAACTGCATTGACAGGATTTCAGAACATGACCCGACCCCTTTACCCTACATTATGCTGGCAAAGTATATGTCATATGACAGGAACACGTTGAAAAGCATTCTGTGACACTACTGGTTACGAGAGTCTATCCGACTTCATACGGTGTCCTAAGCGTTCTAAATTTCGCACTGGCGAGGAGCTGTCCGCGGTCCCACCCGGCGTCCACACTTTCAGCTACAATTTGCATACTCCAGAATTCACAGCCATGAACCCGTCATCAACGGCGAGATAATGTCAAAGAGCGTCTAACATGACGCACCTTTCTCCGCGAGAGCTGTCAGATGCCAATAGCCCGTGTAAAACACAATGTTAGCTCTGAGATTGGTCTCTGTATTCATCTATCTTAAGGGCTAGCTCCCGAGACCCTTGTGTTAAAGCTGCGATAGGAAGACTTTTCACGAATACGCAACCACAATGACTCTCCCTTGCGTCTGGAAGAGTTGACCCGACACTTGCGCAGCGCTTTGAACTCTTGAAATTACTTAACCGGCGTAACTTGTGCAGGGTCGTATATTCCTTGAACTATCGGAGCGCAAGGTATCGGGAGTAGGTGTACCGATTTGCGCTCTTCGACATAATTTCACCGTTTATTTGCCTTCAACAAAAATTGCCTCCGCACTGCTAATTTTCAGAGTTTCGGGGTCACCTGACCGTACTATGTGTCAGACAGAATCAATGCCATGCATGTTAGTAACAGCATTGCTCTGGAAACTGCGAACTAGGTAGGAAAGGGCCCCAGTCATCTTGAGAGAAACTAGGGAGCGGGGGCATAGGGGCCTCATCGAGATACTCCATTCCGGATGGTGTTTCGTTCGGTTAAAAGACGTCATACGTCCACTCGCTTCGTAGTGGCCATGAGTATTCCTCAGGGAACCTGAAGTCCATTAGGGTGATAAGCTTACCGAAACTTACAACGACTGCATCGATTGGCAACGTAAAAGGGCCCTGACGACCCCGTACCATTACCAGGCTTATTATAAGGTCGGTACACAGCACAGTGATTGAATGATCGACTGTGTTCAGCTCAACACCCCGGACAGACATCTTATCTTAGTTCCTACTCTGCTTATCGGCTACCCCCATTATAGTAAGCCCCAGCTTCGTAACAACAGAACGGGCTTCTGGGACCACGCTAGAAGACAAGAAATGGGTCGAACGAAACCCGAGAAAACCAAGCGCGGTCCAATACGGCACTTATTACAGCGGGTTCAGCTGAGATGGCGACGGAAATTTGATAGACAAAGGCCCTCCGCTGATGATGAAGGGAAGACAATTATTCTACCCCTCGATCTTCGTATGGTGCCTTACTCGCGTCTCTTTCGTGGAGGCTGATGGGTGACTTGCAGTGTGTCTTCATTTCAATCGACCACGGATTGAAGATGACGGACTCTTCGCGTCGCATGAAAGTAGGCCTTACTATTATCTCACCGCGCCCTACTACCGGGTGGCGCCACGCAAACTAATAAGGGCCTAGCACAAAGGTTTTGCTTGTCAGCGAATAAATGGAAAACTCCAGCAAATCCCGGTCGACAGGTTGCACCATACGAATCTCGAGAATGTCTGGCGCGCATGGAAAGTGGAAAACCTAACGGCGAAATCATGTCCAAGAGCGAAATAGTGATCAAGTACTTCAACGAATACCTGTTGGGTTATCCGGCGTTGTGCCTCGAAACATCGTGCCCGGCCGCGGGGGCGACTTGGACATAATCTCGCCATTTGACCTCACATAGCCACCGCGTTTATAAAACATGTTGCCAGTGCAAGGATACCTTTGTCCACAATACTAGTGCTCAGTGTCGATTCCAACGTCAACTAATACAAATTCCTGGACTTAACGTTCTTAATCAAATTTACAGTTATATCACAGCCATAGCTAGTCGTGTAGTTCTCTCGCTGGAAGTTGCGTCGTGTCCCCGTCATAACAATTAGCGCTAGAAATTGTGGACTAGTTAGAACACCTCAGGCGAGAACAGCATTAACTTACGCGACAACGTAAGCACCCACCAGGGATTTTCGTCAATTCGGTCGGATTGGCCAGCCGACGAAGCCGCGAATGCGCCAAACCATGGGCGGTAGGTTCCCTTGAACATCCAGGTAACGCGAATTGAACTCTTATTGAAATGAGCACTGTGCTGACCTTGAGCAGTCAGGGGTCATCACGGATTAGGCGCACCACATGGGACTGTTCCTCATCCGCAGGCTCCGAATGACGTGAATGTAAGCCCGATTACTCAATTTGCAAACCACCCCCGTGCTTAATCGTGGTAATCTAGCCTCTCAATGGTGAAATAATGAGTAAAAGCCGCGAACGAGTATAGCCCCAGAGCCATCGGTATGAAACTTACATGACGAGGGATCTCCTTCCTATTAGGGTTGACGGCTCGGGCAGCAATGCTCCCAACCGACTCACCAATAATGATAGGATCGGGCACTTTATGGAACGTAAATGATAAAGCAGGTCAGAATGGAGAAATAATGAGCAAGTCGTCGCACCAACCTGCTTGTCCACGTATGCAGGAAGACTCCGTAGCGAAGGTCACGTCCAACCGAACCCCCACCTTCTGCTTATGGTACGCGGTTAATAACAGCACTATTGGGTCAGTGCAAGGTTTTTTTCGCATGCAATACAGGTCATGTACTTAGAGGCTAGCAACTGCTGAATCTGCTCCGGATTTAGACATGATTTCTCCGTTCTTGATTAACTTGTACGGCTCTTACTCATAATCTCCCCATTCCGCACCTAGTAAACGTCACTGCGTGTAAGTATGGATCCGAGGTTATGAACGACCCCACCAGGAATCAAGTCGAATTCTCTTCAGGCATATGCCTCAAGAATTTCCATAAACTTGGCAAATTGATAGCCGCTAAGAAGATTCTAACGTTGCTACAAACACCGCCCAGAGCGAACGACAGCCTCGACCGTATCAAGCTTCAACGGTGAAAGTAACTAAATCAAATGAAAGGGTTCGAGGATTTGCAAACTCACAATCAAGCCACGGATAGCGTTAGTAGCGGTGATTAACTTCTCGCTAGTAGCGAAACGGGAATTTCTGCCCACCCTTGCTCACGAATGTTGGACATTTCATCTGGTGTCCGGAGGAGATAAGTACTGTCTGGGACAGGGGCAAGCTCCTCTACACCTGATGGTTTACTTGGTTAAGCTCGGTCAGCAAGATTTGCGAAACCCAACCGTTTCATACGAACGCATAGAGGAAAAACCAATTAAACTCTTGTCGCACCGCAATCGCTATCTCCTCCCTGGGAGATTTCGATGGTTGGTACCGTGGCAGCGTGACCTCTCTATTACGATAGCTGAAGGCTGGATTGACAGGAGTTACATAATACACGACTGACCGCAGAATGCGAGCGGTTGCGGCACATCTCGAACTAAGAGCTGCTTAGGGTATACACGCTCCGACACGACGACTATAGATATCAGAGAGGGACTCGGCCAAGAGGTGTGGATGTCTGAGCCAACACAATTTTCTAATGGCCAAACAAACTCTGACCTGCAACTCAGAATCCCATCTGCCAGTCCACTCCTCGACTCCTTCGGCCTACAGCTATCACCCTGACACGTCACTCTCTTACTACCTACTTTCTCATGGGCTTGACTCTCATTTAATGCGATACATGATTCCTTAGTTAAGATGTGTTGCTCGCCACCTACTGCTAGATCCGGTGGCACCGACGCATTACCGAGCGGAAGCTAGGATTTGTGCCAGATGTTGCGTCCCCTTACGCGATTATCGAACCATAGATCATCGCACGGCCAGAACCTGCCCGATTATATCATGTAGGACAAGCTCATTGGTGGAGAGGTAGAAAAAGAATCTCAGTGAGTTCGCGGTGTCAGTAAAACGACGGGCCTAATAGCAAGGATCAAGACGATCGGCTATGAGGTGCCTAGGATGCAGGCCTCGAATACTCGGATGTATAGGAACAGACCGGGTCGTCTTGACGGTTATGCTGAGGTCGTCGATGTGGTTAAAGTTTATGAGTCCATGTGCGCGCTCAGGATTCGAAGTGATCAGTGCTATCCGCAAGGAGTGTGCGGGTAAGGGTTCAGCGACGCAAGTAATGCGTGACGTACTTCGTATACGTACCATAACACAACTTTCAACAAATGAACTTTATGTCTGCCTCGTGCTCGGAATGGTTGACAGGGCCATTCAAAATAGAGTTCAACTCGCGGTCGCTTTCGGGCAACAGATTTACAAGTTAATAGTAAATCGTCTGGTGCCGGAGGTCCTGGATGCAGTAATAAGTAGAGACAACCTCTCCTGCGATTTCGTGGCACGCCTCGAGTACATGTTCGCCTTCAGCCGGTGTCACGGCTCGACACAACCTACTATTTGGCTTGACTTAAGAAGCCTATGGAGCAGTGTAACGCAAGTGAAGCCTTTCGATTTGCTTGATAGGATCCTAGTGATGTAGCTAAAGCAGTAGCCGGGTACGTTATTTCACTGCTTACTTAGTTGGCCCAAGTCTGGAGTGGGATGTGCAGTGGCAGACCTTGACATAGTGGCGGGGCGTCGGAGTTGAAACAGTATGTCGCGTTATCTTTCCATCCTGGGATGATTTACCAGATATGGACGCGGCTGTACACCCAAACAAGCTTTAGTGGGTCGGCCTTGCCTAGAA"
tyrocidine = "VKLFPWFNQY"

peptide_string = tyrocidine


def main():
    rna_string = read_file("B_brevis.txt")
    reverse_rna_string = reverse_compliment(rna_string)

    # with progress_bar(len(rna_string)) as progress:

    # print(translate_rna(rna_string))

    rna_encoders = []

    len_peptide = len(peptide_string)

    word_size = len_peptide * 3
    with progress_bar(len(rna_string)) as progress:
        for i in xrange(0, len(rna_string) - word_size + 1):
            progress.update(i)
            rna_substring = rna_string[i:i + word_size]
            reverse_rna_substring = reverse_rna_string[i:i + word_size]

            if rna_encodes_peptide(rna_substring, peptide_string):
                rna_encoders.append(rna_substring)

            if rna_encodes_peptide(reverse_rna_substring, peptide_string):
                rna_encoders.append(rna_substring)

    pprint(rna_encoders)


if __name__ == '__main__':
    main()