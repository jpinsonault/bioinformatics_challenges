from collections import defaultdict
from pprint import pprint
import re
import pickle

from utils import *

genome = "GATTAGGAACCACTTGCCTAACCCAACTGCACCCACGTGACTAAGATTTGCAGCTCGCGGCCGGTGCGTGTCGATGGAGAATGTTTCCGCGGCATGTAAAAGGCCCGTGAACACTTGTCGCTTGACTTATATCGAAGCAGCAAGACACCAAGATATTTACGGTCGCAGACGCAACACTGCAGCGCCGTAAAGGGGATCTGCTCCATTCGAAGAGGATAGGCGCAATAAAGCACTGGTTCCGACAATAGGACTGCATTTCGATCCTCGCATAGAAGCAGAGCCTACAAACGTGGGGGATGGCCGCTTTAGGCGACCCAGAGAATTCCGCTTTGAATCGAACAAAATATGAGAGGTCGACGTCAGATTACCAAGGTGATCAACAAGCGTGTCGGCGCCACCATTGTAACACAACTTTAGGGGACAGTCAAAGGCTATCGCTTATCGTTAGATGACTACTGCGGCCCGGTTGGCTACACCCCTAGGCTAGTAGCGATTCCTACAACACGAAGCTTTTAGTTCCGTGAGGTAGTAGTCCAAACTGGGATTGAGCGGGATGACTTGAAGAACTAGCACGGTCGTATTAATTTGACGAGATGCCCATCATCTATCTCCCTGATCCTAACGCCAAAGCCCATCATCTATGAGATCGGCCGGCGGAGCCGATGGCATTCCGTGCTGACCCATCATCTATCCTACCCATCATCTATAATCTTCTCCCATCATCTATTCGCGCTAACGAATCCTTGAATCTTATCCGGCGTTGTACAGGTGCCCATCATCTATATCCCATCCCCATCATCTCCCATCATCTATATTAATGGCGCTACTCCCATCATCTATTATCGAAGCCCATCATCTATTTCCCAATACCCATCATCTATCCTCCCCCATCATCTATCTCGCGACTAACTGCCCATCATCTATACCCTCCGCCCATCATCTATACCCATCATCTATCCGGGGAACGCCCATCATCTATTCTATCGCTGTTCCTGTTCCCTACGCTGTAGAGTTTAAACGCTCGACCCATCATCCCATCATCTATTCATCTATTCCCCATCATCTATTCCGATGACGTTGTACGCTGTTCGACCCCATCATCCCCATCATCTATCCATCATCCCCATCATCTATTCTACGCTTCCCATCATCTATGCAGAAAGGCATTAAACCAACGACCGTGTACGCTGTTCAGATGTACGCTGTTCATGGAACTGCTGTACGCTGTTCCGCAGCGGGTAAGCGACACTAGATGTACGCTGTTCGTACGCTGTTCACACACAGCGTCTCCTCGTGTACGCTGTTCCGGCGTAAGGTGGAAAGGAGAGCTGTACGCTGTTGTACGCTGTTCTAACTGGATAGATGTACGCTGTTCAATGCCCCATGTAGCGAACCGATGGCTGTAGATTTTGATTTGCAGCTGCAAGCCGCAGGGCCAGTTTTACCAACTACTTGTACGCTGTTCTTCTGTACGCTGTTCACGCTGTTCCGCTGTTCCTCAGGTGCTGTGTACGCTGTTCCTTCTCACGATTGATGAACCAACATGTCTCCACGTGTGCCTGAAACAGCATACATTTGTCCATACAGATAGTACTCTACTCAAGGGTGGCGCGTGTTATCTCAGGCGCCTATTTATACGACCTGATACAAGAAGCGAGAGAAGTGCACCGGCGAAGTCCAGCCCCCAGGGCTGCACTCAACCGCTCGGGGCTGAAGCGCATCCCTTGGCAGCGATGACGGCGATGGAACCCTCAGTTCAACATGAACCGCCGGAAGACGCCAATCCACGCGACGGCCGCAACACGCCGCAGTTGGTTTCATATGCAGTCGGATATCCTAAGTGGCTAGTACTGTACCATGACGCCCGCGAGGAAGCAAAGTATAACCAACAGGCGATTATAGTGATGCAAACGTAGAAATAAGCAGCTGTCTTTGTGCCTAGCTAAGAGATCTCCAAGTCTACATTGTTCGAGAGAGGTAATGTTCGAAAGTCGCCTCGATATGGTGCATGTGCTTAGAAGTGGCGCTTAGGTCCTCCCTGAGGCCATAACTTGCAATTCAAATGTTGACACTCGCGGGCTTCAAGCAGCGCCATACGGATGCCTTGCGAAAGCAATGGTCGTCGCTGTTTCTAGAGTTCGTGGCCAGTACTTTGATACTAAGTCATGCTGACTGAGGGTGATGTAGGGGGACTTTTAGGTATCTGGAAAAATGCCTCTGTGCGATGACAAAAGGGCCCGTTATCTAAGGGCATTCATGTCGGGCCTCGCCTACGGTTAAAGAGAAATCCCGTCCTACTAACCTTTTTGTTCGGAAGGTGTGGTCTCGCTACCACAAATGTCTAAAGACTCGGACAAAGGAATTACGCGTACTGCGACGCATTCTTGGATTGGTCACGGACGGAGACGACGCCGCTTCTTTTCTGATTAATATAGTCATAGACCAAGAACAAGTAGATTATTCAGCGTAAACTCCTCGTTCCCCTGCCCCCTATCCGCCAAGACTATTTGCGCTCGTTCCCCTGGTACAGTACAGCTCGTTCCCCTGGCCGGACTTACAAACAGACTCGTTCCCCTGAGCCATAATATGTTAGTGTTCTCCATTCCTACAGATTCTCGTTCCCCTGTAGACACCTGAACTCGTTCCCCTCGTTCCCCTGCACTTGTAGAGACTCGTTCCCCTGTTCGCTATCTGGGTTCATCTCATCGGTGCAAGGTACTCGCTCGTTCCCCTGTGTTATTATTAAGCTTCAGGGGTACCCTAATCACTCGTTCCCCTGAGCGTGATACCTCGTTCCCCTGTCCCCTGGGTCTCACCGGGGCACCTCGTTCCCCTGCGCCCTCGTTCCCCTGATTCGTAACTCGCATAGCGAAAAGAACTCGTTCCCCTGTCCCCTGACACCAGGTATGCCTGGGCTCGTTCCCCTGCCCTGTCCTATGGGCTCGTTCCCCCTCGTTCTCGTTCCCCTGCTTGGTAAAGCATTACCGGGTCACTCGTTCTCGTTCCCCTGCCTGTTCCCCTGAGAAGGAAGTAGCAATCCGTCAACACGCACTTCGAATCGGCAAAAACCCCAGACTTAGGTTCTATACATTGTTGGGGCTCTTCCAGAAGGAGTTGAACGGGGCTGTAGGAGGTGTAGAGGGGTTCAGGGTTTGACCTACGAAGTCTATTGCATGTACTGCAAAGACAGCGTGTGACCATGCTATTCAGAGAGGTTAATGAAGTGACTACGCCACCAGGTAATAACACGATGTTGTTATTCTACTAAGGCGGCCCAGGAGCGCCCGATGCATAACGGACATAGATTATCTTTAATGGAGCAGGCTTTGGGCCGGAGAAAGTCTACCCCCCTCCCGCATCATAAGGAGATGGGGACCTGAGGTTGGCTATAGTAGACTCATATCAGCTGACGCTCTACATACCGTAAGGCCCACATCGAGCGCTCCGCACCCCCCTGGGTCAACTCTCGTGTGGGACCAGAAGCCAAGAAACCGTGGCAGGGGTTCCGAGTCTAATCCACTGGTGTCTGCGGATGAATCACAACGTTACCATTAAGTAGAGCTCCACGATGGCCTGGTAAAACGTTTAAAATAGCTCTCGGCACAACGCTATAAAAACTTCGGATGTTGCAGGATTGTGCAACCGTAGCACGCTTAATACATGCACTCTGGTCAGACTACGTCTGTCATTAACCCTAGCTAAAGAGCGAGAATTTTTTAGTCCGGGTAATTCTGACCGAGGACTCCAGCCAGGCCGTGCGGTAATTCTGTAATTCTGACCGTCTGACCGGCTTTAATTAATTCTGTCGGAGGTGTCGCTGACCGCATCGGATCGGATCGGAGGTGTCGCGTCTGACCGTCGGAGGTGTCGGAGGTGTCGGGTAATTCTGACCGCTCGGTGCCAGTATCGGAGGTGTCGGGAGGTGTCGCTGTCGGAGGTGTCGGCTAATAATTCTGACCGCTCGGAGGTGTCGCCGGGCTCTCGGAGGTGTCGGAAATAATTCTGACCGTCCGTGTGGCTTTCTCGGAGGTGTCGGCCGATCACGTTATGCCCAGCATCCTTGTTAATCGGAGGTGTCGTCGAGGTCGGAGGTGTCGGGAGGTGTCGCGCCTTGTGCAGTGCAAGGCTTGCATACTCGGAGGTGTCGGTTCGGAGGTGTCGTGACCGTCCTTGTGCATGAGCATCTCGGAGGTGTCGCATCTAATTCTGTAATTCTGACCGCTCGGAGGTGTCGGAGGTGTTCGGAGGTGTCGTGTCGTTCTGACCGGCCCATCCTTGTGCATAGTCCGAAGCCCGGATACACTCTTCATCCTTGTCGGAGGTGTCGATGTGAATTGACCTGAGGGTGGTTCATCCTTGTGCACGTATTGGCATAGCGCGCATAAGCCATCCTTGTGCAGCAATGTCTGCACGATGAGTTTAATCGCTAGAAACATCATCCTTGTGCACCATCATCCTTGTGCAAGGAACCGGCATCCTTGTGCATAAGTCCGGACATGGGAGTCATCCTTGTGCAGCTGTCCGCGCCCACATCCTTGTGCAGTGCACTTGTGCAGTAATTGGCATCCTTGTGCATGTGCATATGGCAGTGTCTCTACTGTGCATCATCCTTGTGCAATCGCAACACATCGACTAACGACCCGCTCGGGCAAGGAACTTGCTGAAAGTAGATACGAACGTCTGGATCGCAAATTTTTCCTGGGCTAGTCAGGGGCGGTGATCAGTGGAACCTTTGCTAAGCGATGGTGCGACGGATACCGTGTGACAGAAAATTTACGAGCTCGATACACTTCTCCATGGCGTGAACCTCAAAATCGACCACCAACTTCAAAACTGATAAGCTCGGTCTTTTTATTCGGCTACACCCGACTATTAAACCATACTCTGTAAAAGACCTGCTCGAACCTAATAGTGTACTAGTCGTTGTTAGTAGGGATCACCGTTCCATAATTGGTACCCATAGTTGGTACCCATAGGGTACCCATAGTCGGGTACCCATAGTCAAGGTACCGGTACCCATAGTACCCATAGTCGGGTTTCACGGTTTTGTGGCCAGGGTGCATAGGTACCCATAGTGGGTACCCATAGTGCAGGGGTACCCATAGTTGCATAAGGGTGCATGGGTACCCATAGTGAAATAAGGTACCCATAGTGGTGCATAATTACGACGTGTTCGAGAGGGGGTACCGGGTACCCATAGTTGGTCAAGCACGGTACCCATAGTCTCTACCGGTACCCAGGTACCCATAGTCATAATGTTGCGCATAAGGAGGGTGCATAATGAAGGTACCCATAGTGTGCATAATGGGAGGGTGCAGGGTGCATAATTGGGTACCCATAGTTCCCAGGGTGCATAATACGATGAACCTCCCCGGTGGTACCCATAGTACCCATAGTTACAGTGTTCGGTACCCATAGTGCATAATCATAAAGCACACGTGGCAAAAGCACACGTGGTAGTGCAAAGCACACGTGGGAAGCACACGTGGCACACGTAAGCACACGTGGTATCATTCGCCCAAGGTAAGCACACGTGGGCACACGTGGAAAGCACACGTGGGGTGCGTTTTCAAGAGGGTGCATAATGAACCGGAGAAGCACACGTGGTCACAAAGGGTGCATAATAAGCACACGTGGGGTTACGGCGCAAGCACACGTGGTATAAAGCACACGTGGCCAAAAGCACACGTGGCGCCTGGCTGAGTTATGACCCCCTGGCTGCCCACGCGAACGCCAAGCACACGTGGACATGCGATGTTGGGCAAAGACTAAAGCAAGCACACGTGGGCACACGAAGCACACGTGGAATCCTCTTCCAGATACCAGCTCTAAAGTCAAGCACACGTGGTAGTGTCAGTGCTGTCCCGAAAGTGTAGAAAGCAAAAGCACCCAATTTTTCCTGAATAAGCACACGTGGACTGCCATTTCCCACCCCCAATTCCCAATTTTTCCGCCCAATTTTTCCCCAATTTTTCCAATGTACAGAAGGATGGTCGGAAGCACACGTGGGCCTAATCCCAATTTTTCCGTTTACCATGAACTCTCAGCACCCAATTTTTCCCCACGCGCCCGCATTGGTCGCGCCCAATTTTTCCTGGTTACCCGTGACACACGACCGCTTGAATACCATCAATACCCTCCCAATTTTTCCTTTTCCTTTTCCCCCAGCATAACATATCCCAATTTTTCCGGGGTCACCCAATTTTTCCGGATCCCAATTTTCCCAATTTTTCCTTTCACCACTGAGTCCCAATTTTTCCTCCCTGTCCCCCAATTTTTCCATTGTACGCGGTTGGTACCTCCCAATTTTTCCATTTTTCCTCCCAATTTTTCCACGGGTTCAGAGTCACTGTCCTCGAGTCACTGTCCCCAATTTTTCCGTATACCCCAATTTTTCCTCCGCTAACCCAATTTTCCCAATTTTTCCCACTGCCCAATTTTTCCTCACTGACCCAATTTTTCCTCACTGTCCACGAGTCACTGTCCTCCAGATTTAGACCTTAACAAGCTAGACGCCCTTGTCGCGCAGTTTTGGGGAGTCACTGTCCTCCTGCTGAGTCACTGTCCAACGGAGTCACTGTGAGTCACTGTCCCAAAGGGGGACGAGTCACTGTCCGCGGTGAGTCACTGTCCCGTGAAGCGCGAATCTGTCGAGAGTCACTGTCCCGTGAGTCACTGTCCCCGAGATGAGTCACTGTCCGTCACTGTCCACGCGAGTCACTGAGTCACTTCGGAAGCGTACCAGTGGCGCTTAGAGTCACTGTCCCACTGCACCACTTTTGTACTGTTTCTCACGAGTCACTGTCCTGTCCATAAATATTCGGAAGCGTACGAAGCGTACACGTGCCAGCTACCCCGACTCGGAAGCGTACCACTTATAACCTCGTCGGAAGCGTACAAGAGCGAAAACTCATGTGGGATATTGGTTGCCTCGGAAGCGTCGGAAGCGTACTGTGACCCGACTAGGTGGGTCGTCGGAAGCGTACCGGAAGCGTACTTGGGTCGGAAGCGTACGGAAGCGTACCTCGTAAAGGCGCCCTCTCGTCGGAAGCGTACGGCCACGACAGCACATGGTGGCTCGGAAGCGTACCAACCCTCGGAAGCGTACTCGGAAGCGTACGTACTCTCGCTAGTAATAACAGACTTCGGAAGCGTCGGAAGCGTACCGGTGGTCTTCAGAATGAGCTTTCGGAAGCGTACTGATGTCGTCGGAAGCGTACGGAAGCGTACTGCGTAATCGGAAGCGTACAGCCAGTCGGAAGCGTACGCCCATAAACAACGCCAAAGTCGGAAGCGTACCAAAATTCACGATGTCACGCCCGCGCGACTGAGGTCCTAAATCTTAGGAGTGAGCCCATTAGGCCTTAGCAAAGTGTATGTTAACCTATGATCGGAGCATGTCCTTTATCTGGACCTGTTCGTTCGCAACGTGACCTGGGAGCACTGTTTTACACGAAGCATTCATACCTTTAGATATCACTTGTCATCTGATTTCGAGCTCTGACTTCTTGGTCATACAATGCAATGTTGTGTATCGCATATCTCGTGGCGGTACATTCTCAGTTACGCAGTACTGTTGACCGGCCGACGAGCCCGGTTCACAGACTATTTGATATTCTATATGGTGTGTTAAAAGACGCGCGTATCACTTACGACCGTCATGCACCCTATAATATTAGGGAGCAATCGCAGACCCTATAATATCCTATAATATAGTACCACCCTATAATATTATAATATATTATTGCACCCTACCCTATAATATCCTCATAGGCGAGTGACTCGATGTCAAAGTCGGGCACGGTGACCCTAACCCTATAATATCTAATTGCCGGGTTGACCCTATAATATTTTCTCAATCGGTTATTCACCGTAAACCCTATAATATTTTCACCCTATAATATTAATAACCCTATAATATTAATATTGGTCGGGACATCGGACCCTATAATATTATGCCTCGTACATATGCCTCGTACCCGCGTCTTTGTATGCCTCGTACATATAAACCACACCCTATAATATCCACAACTGACCCTATAATACTATTATGCCTCGTACATATGCTATGCCTCGTACTATGCCTCGTACCCTCGTACACGAGTAGTTATATGCCTCGTTATGCCTCGTACTTAGATATGCTGGAACTATGCCTCGTACTGCCTCGTACTGTACGCGGTCAGCCAGCAGTATGCCTCGTACATGCCTCGTACGTACCTATATGCCTCGTACGTATGCCTCGTACGTTCGGCCCATTATGCCTCGTACCTCGTACGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTTTATGCCTCGTACGCAGTTGGCGTCGCTATGCCTCGTATGCCTCGTACCGCAGTTGGCGTCGCAGTTGGCGTCTATGCCTCGTACGCAGTTGGCGTCGCAGTTGGCGTCGTATGCCTTATGCCTCGTACACACGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGTCGCAGTTGGCGCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGACCGCTAAAGGGAC"
k = 9
L = 500
t = 3


def main():
    genome = read_file("E-coli.txt")
    
    # kmers = [kmer for kmer in find_kmers(k, genome) if len(kmer) >= t]
    kmers = find_kmers(k, genome)

    print("Found kmers")

    clumps = []

    for kmer, locations in kmers.iteritems():
        num_locations = len(locations)
        if num_locations < t:
            continue
        # start, end, = locations[0], locations[-1]

        for x, location in enumerate(locations):
            # If there are enough locations left
            if num_locations - x >= t:
                start = location
                end = locations[x + (t - 1)] + k

                if end - start <= L:
                    clumps.append(kmer)
                    # Break because we only need to record a kmer once
                    break
            else:
                break

    print(len(clumps))


if __name__ == '__main__':
    main()